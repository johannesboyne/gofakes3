# Check https://circleci.com/docs/language-go/ for more details
version: 2.1

orbs:
  go: circleci/go@1.11.0

jobs:
  build:
    docker:
      - image: cimg/go:1.23
    steps:
    - checkout
    - go/mod-download
    - go/test:
        covermode: atomic
        failfast: true
        race: true
    - run: go run makefile.go cover coverage.txt
    - run: bash <(curl -s https://codecov.io/bash)

workflows:
  main:
    jobs:
      - build
